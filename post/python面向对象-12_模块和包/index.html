<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.86.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>Python面向对象-12-模块和包&nbsp;&ndash;&nbsp;Wei Chu</title><link rel="stylesheet" href="/css/core.min.746d4f5e0f69f8ca3fdabdfef6b99d63a9852de221102d14b47177e2a4e0fb979941c84b1ae5b6a490e592140624482e.css" integrity="sha384-dG1PXg9p&#43;Mo/2r3&#43;9rmdY6mFLeIhEC0UtHF34qTg&#43;5eZQchLGuW2pJDlkhQGJEgu"><body>
    <div class="base-body"><section id="header" class="site header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><img class="site logo" src="/images/logo.png" alt /><span class="site name">Wei Chu</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories/">Categories</a><a class="nav item" href="/tags/">Tags</a><a class="nav item" href="/about/">About</a><a class="nav item" href="https://gohugo.io/"target="_blank">Hugo</a></nav></div></span></div><div class="site slogan"><span class="title">醉后不知天在水 满船清梦压星河</span></div></section><div id="content"><section class="article header">
    <h1 class="article title">Python面向对象-12-模块和包</h1><p class="article date">Oct 22, 2021<span class="reading-time"> • 4 minutes to read</span></p></section><article class="article markdown-body"><h1 id="模块和包">模块和包</h1>
<h2 id="目标">目标</h2>
<ul>
<li>模块</li>
<li>包</li>
<li>发布模块</li>
</ul>
<h2 id="01-模块">01. 模块</h2>
<h3 id="11-模块的概念">1.1 模块的概念</h3>
<blockquote>
<p><strong>模块是 Python 程序架构的一个核心概念</strong></p>
</blockquote>
<ul>
<li>每一个以扩展名 <code>py</code> 结尾的 <code>Python</code> 源代码文件都是一个 <strong>模块</strong></li>
<li><strong>模块名</strong> 同样也是一个 <strong>标识符</strong>，需要符合标识符的命名规则</li>
<li>在模块中定义的 <strong>全局变量</strong> 、<strong>函数</strong>、<strong>类</strong> 都是提供给外界直接使用的 <strong>工具</strong></li>
<li><strong>模块</strong> 就好比是 <strong>工具包</strong>，要想使用这个工具包中的工具，就需要先 <strong>导入</strong> 这个模块</li>
</ul>
<h3 id="12-模块的两种导入方式">1.2 模块的两种导入方式</h3>
<h4 id="1import-导入">1）import 导入</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">模块名1</span><span class="o">,</span> <span class="nn">模块名2</span> 
</code></pre></div><blockquote>
<p>提示：在导入模块时，每个导入应该独占一行</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">模块名1</span>
<span class="kn">import</span> <span class="nn">模块名2</span> 
</code></pre></div><ul>
<li><strong>导入之后</strong>
<ul>
<li>通过 <code>模块名.</code> 使用 <strong>模块提供的工具</strong> —— <strong>全局变量</strong>、<strong>函数</strong>、<strong>类</strong></li>
</ul>
</li>
</ul>
<h5 id="使用-as-指定模块的别名">使用 <code>as</code> 指定模块的别名</h5>
<blockquote>
<p><strong>如果模块的名字太长</strong>，可以使用 <code>as</code> 指定模块的名称，以方便在代码中的使用</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">模块名1</span> <span class="k">as</span> <span class="nn">模块别名</span>
</code></pre></div><blockquote>
<p>注意：<strong>模块别名</strong> 应该符合 <strong>大驼峰命名法</strong></p>
</blockquote>
<h4 id="2fromimport-导入">2）from&hellip;import 导入</h4>
<ul>
<li>如果希望 <strong>从某一个模块</strong> 中，导入 <strong>部分</strong> 工具，就可以使用 <code>from ... import</code> 的方式</li>
<li><code>import 模块名</code> 是 <strong>一次性</strong> 把模块中 <strong>所有工具全部导入</strong>，并且通过 <strong>模块名/别名</strong> 访问</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># 从 模块 导入 某一个工具</span>
<span class="kn">from</span> <span class="nn">模块名1</span> <span class="kn">import</span> <span class="n">工具名</span>
</code></pre></div><ul>
<li>导入之后
<ul>
<li><strong>不需要</strong> 通过 <code>模块名.</code></li>
<li>可以直接使用 <strong>模块提供的工具</strong> —— <strong>全局变量</strong>、<strong>函数</strong>、<strong>类</strong></li>
</ul>
</li>
</ul>
<p><strong>注意</strong></p>
<blockquote>
<p>如果 <strong>两个模块</strong>，存在 <strong>同名的函数</strong>，那么 <strong>后导入模块的函数</strong>，会 <strong>覆盖掉先导入的函数</strong></p>
</blockquote>
<ul>
<li>开发时 <code>import</code> 代码应该统一写在 <strong>代码的顶部</strong>，更容易及时发现冲突</li>
<li>一旦发现冲突，可以使用 <code>as</code> 关键字 <strong>给其中一个工具起一个别名</strong></li>
</ul>
<h5 id="fromimport-知道">from&hellip;import *（知道）</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># 从 模块 导入 所有工具</span>
<span class="kn">from</span> <span class="nn">模块名1</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div><p><strong>注意</strong></p>
<blockquote>
<p>这种方式不推荐使用，因为函数重名并没有任何的提示，出现问题不好排查</p>
</blockquote>
<h3 id="13-模块的搜索顺序扩展">1.3 模块的搜索顺序[扩展]</h3>
<p><code>Python</code> 的解释器在 <strong>导入模块</strong> 时，会：</p>
<ol>
<li>搜索 <strong>当前目录</strong> 指定模块名的文件，<strong>如果有就直接导入</strong></li>
<li>如果没有，再搜索 <strong>系统目录</strong></li>
</ol>
<blockquote>
<p>在开发时，给文件起名，不要和 <strong>系统的模块文件</strong> <strong>重名</strong></p>
</blockquote>
<p><code>Python</code> 中每一个模块都有一个内置属性 <code>__file__</code> 可以 <strong>查看模块</strong> 的 <strong>完整路径</strong></p>
<p><strong>示例</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># 生成一个 0～10 的数字</span>
<span class="n">rand</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rand</span><span class="p">)</span>

</code></pre></div><blockquote>
<p>注意：如果当前目录下，存在一个 <code>random.py</code> 的文件，程序就无法正常执行了！</p>
</blockquote>
<ul>
<li>这个时候，<code>Python</code> 的解释器会 <strong>加载当前目录</strong> 下的 <code>random.py</code> 而不会加载 <strong>系统的</strong> <code>random</code> 模块</li>
</ul>
<h3 id="14-原则--每一个文件都应该是可以被导入的">1.4 原则 —— 每一个文件都应该是可以被导入的</h3>
<ul>
<li>一个 <strong>独立的 <code>Python</code> 文件</strong> 就是一个 <strong>模块</strong></li>
<li>在导入文件时，文件中 <strong>所有没有任何缩进的代码</strong> 都会被执行一遍！</li>
</ul>
<p><strong>实际开发场景</strong></p>
<ul>
<li>在实际开发中，每一个模块都是独立开发的，大多都有专人负责</li>
<li><strong>开发人员</strong> 通常会在 <strong>模块下方</strong> <strong>增加一些测试代码</strong>
<ul>
<li>仅在模块内使用，而被导入到其他文件中不需要执行</li>
</ul>
</li>
</ul>
<h4 id="__name__-属性"><code>__name__</code> 属性</h4>
<blockquote>
<ul>
<li><code>__name__</code> 属性可以做到，测试模块的代码 <strong>只在测试情况下被运行</strong>，而在 <strong>被导入时不会被执行</strong>！</li>
</ul>
</blockquote>
<ul>
<li><code>__name__</code> 是 <code>Python</code> 的一个内置属性，记录着一个 <strong>字符串</strong></li>
<li>如果 <strong>是被其他文件导入的</strong>，<code>__name__</code> 就是 <strong>模块名</strong></li>
<li>如果 <strong>是当前执行的程序</strong> <code>__name__</code> 是 <strong><code>__main__</code></strong></li>
</ul>
<p><strong>在很多 <code>Python</code> 文件中都会看到以下格式的代码</strong>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># 导入模块</span>
<span class="c1"># 定义全局变量</span>
<span class="c1"># 定义类</span>
<span class="c1"># 定义函数</span>

<span class="c1"># 在代码的最下方</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># ...</span>
    <span class="k">pass</span>

<span class="c1"># 根据 __name__ 判断是否执行下方代码</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

</code></pre></div><h2 id="02-包package">02. 包（Package）</h2>
<h3 id="概念">概念</h3>
<ul>
<li><strong>包</strong> 是一个 <strong>包含多个模块</strong> 的 <strong>特殊目录</strong></li>
<li>目录下有一个 <strong>特殊的文件</strong> <code>__init__.py</code></li>
<li>包名的 <strong>命名方式</strong> 和变量名一致，<strong>小写字母</strong> + <code>_</code></li>
</ul>
<p><strong>好处</strong></p>
<ul>
<li>使用 <code>import 包名</code> 可以一次性导入 <strong>包</strong> 中 <strong>所有的模块</strong></li>
</ul>
<h3 id="案例演练">案例演练</h3>
<ol>
<li>新建一个 <code>hm_message</code> 的 <strong>包</strong></li>
<li>在目录下，新建两个文件 <code>send_message</code> 和 <code>receive_message</code></li>
<li>在 <code>send_message</code> 文件中定义一个 <code>send</code> 函数</li>
<li>在 <code>receive_message</code> 文件中定义一个 <code>receive</code> 函数</li>
<li>在外部直接导入 <code>hm_message</code> 的包</li>
</ol>
<h3 id="__init__py"><code>__init__.py</code></h3>
<ul>
<li>要在外界使用 <strong>包</strong> 中的模块，需要在 <code>__init__.py</code> 中指定 <strong>对外界提供的模块列表</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># 从 当前目录 导入 模块列表</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">send_message</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">receive_message</span>
</code></pre></div><h2 id="03-发布模块知道">03. 发布模块（知道）</h2>
<ul>
<li>如果希望自己开发的模块，<strong>分享</strong> 给其他人，可以按照以下步骤操作</li>
</ul>
<h3 id="31-制作发布压缩包步骤">3.1 制作发布压缩包步骤</h3>
<h4 id="1-创建-setuppy">1) 创建 setup.py</h4>
<ul>
<li><code>setup.py</code> 的文件</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">distutils.core</span> <span class="kn">import</span> <span class="n">setup</span>

<span class="n">setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&#34;hm_message&#34;</span><span class="p">,</span>  <span class="c1"># 包名</span>
      <span class="n">version</span><span class="o">=</span><span class="s2">&#34;1.0&#34;</span><span class="p">,</span>  <span class="c1"># 版本</span>
      <span class="n">description</span><span class="o">=</span><span class="s2">&#34;itheima&#39;s 发送和接收消息模块&#34;</span><span class="p">,</span>  <span class="c1"># 描述信息</span>
      <span class="n">long_description</span><span class="o">=</span><span class="s2">&#34;完整的发送和接收消息模块&#34;</span><span class="p">,</span>  <span class="c1"># 完整描述信息</span>
      <span class="n">author</span><span class="o">=</span><span class="s2">&#34;itheima&#34;</span><span class="p">,</span>  <span class="c1"># 作者</span>
      <span class="n">author_email</span><span class="o">=</span><span class="s2">&#34;itheima@itheima.com&#34;</span><span class="p">,</span>  <span class="c1"># 作者邮箱</span>
      <span class="n">url</span><span class="o">=</span><span class="s2">&#34;www.itheima.com&#34;</span><span class="p">,</span>  <span class="c1"># 主页</span>
      <span class="n">py_modules</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;hm_message.send_message&#34;</span><span class="p">,</span>
                  <span class="s2">&#34;hm_message.receive_message&#34;</span><span class="p">])</span>

</code></pre></div><p>有关字典参数的详细信息，可以参阅官方网站：</p>
<p><a href="https://docs.python.org/2/distutils/apiref.html"target="_blank">https://docs.python.org/2/distutils/apiref.html</a></p>
<h4 id="2-构建模块">2) 构建模块</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">$ python3 setup.py build
</code></pre></div><h4 id="3-生成发布压缩包">3) 生成发布压缩包</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">$ python3 setup.py sdist
</code></pre></div><blockquote>
<p>注意：要制作哪个版本的模块，就使用哪个版本的解释器执行！</p>
</blockquote>
<h3 id="32-安装模块">3.2 安装模块</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">$ tar -zxvf hm_message-1.0.tar.gz 

$ sudo python3 setup.py install
</code></pre></div><p><strong>卸载模块</strong></p>
<p>直接从安装目录下，把安装模块的 <strong>目录</strong> 删除就可以</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.5</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span>
<span class="err">$</span> <span class="n">sudo</span> <span class="n">rm</span> <span class="o">-</span><span class="n">r</span> <span class="n">hm_message</span><span class="o">*</span>
</code></pre></div><h3 id="33-pip-安装第三方模块">3.3 <code>pip</code> 安装第三方模块</h3>
<ul>
<li><strong>第三方模块</strong> 通常是指由 <strong>知名的第三方团队</strong> <strong>开发的</strong> 并且被 <strong>程序员广泛使用</strong> 的 <code>Python</code> 包 / 模块
<ul>
<li>例如 <code>pygame</code> 就是一套非常成熟的 <strong>游戏开发模块</strong></li>
</ul>
</li>
<li><code>pip</code> 是一个现代的，通用的 <code>Python</code> 包管理工具</li>
<li>提供了对 <code>Python</code> 包的查找、下载、安装、卸载等功能</li>
</ul>
<p>安装和卸载命令如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 将模块安装到 Python 2.x 环境</span>
$ sudo pip install pygame
$ sudo pip uninstall pygame

<span class="c1"># 将模块安装到 Python 3.x 环境</span>
$ sudo pip3 install pygame
$ sudo pip3 uninstall pygame
</code></pre></div><h4 id="在-mac-下安装-ipython">在 <code>Mac</code> 下安装 <code>iPython</code></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">$ sudo pip install ipython
</code></pre></div><h4 id="在-linux-下安装-ipython">在 <code>Linux</code> 下安装 <code>iPython</code></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">$ sudo apt install ipython
$ sudo apt install ipython3
</code></pre></div></article><section class="article labels"><a class="category" href=/categories/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/>Python面向对象</a><a class="tag" href=/tags/%E6%A8%A1%E5%9D%97%E5%92%8C%E5%8C%85/>模块和包</a></section><section class="article navigation"><p><a class="link" href="/post/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-11_eval%E5%87%BD%E6%95%B0/"><span class="li">&larr;</span>Python面向对象-11-`eval` 函数</a></p><p><a class="link" href="/post/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-13_%E6%96%87%E4%BB%B6/"><span class="li">&rarr;</span>Python面向对象-13-文件</a class="link">
    </p></section></div><section id="footer" class="footer">
    <script src="https://utteranc.es/client.js"
        repo="ChuWeiEr/hugoblogtalks"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><div class="footer-wrap">
    <p class="copyright">©2020 Notepadium.</p>
    <p class="powerby"><span>Powered by </span><a href="https://gohugo.io" 
        target="_blank">Hugo</a><span> and the </span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank">Notepadium</a></p>
</div></section><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/&#43;DiW/UqRcLbRjq" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l&#43;B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd&#43;qj&#43;o24G5ZU2zJz" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script></div>
</body>

</html>